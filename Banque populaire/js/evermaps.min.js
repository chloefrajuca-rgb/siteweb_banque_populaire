(v=>{evermaps.jslib.Loader.onLoad(function(){v(function(){var r=v("html"),e=v(".block-form-full form"),s=v(".container-form",e),o=v('input[name="list-radio"]',e),i=v("#street",e),l=v("#city",e),a=v("#opening",e),t=v(".button-geoloc",e),n=v("#modal-error"),c=v("#modal-error .modal-bottom p"),u=[],p=evermaps.customer[evermapsScriptData.widget_name].SearchWidget.create(),d=o.filter(":checked").val(),m=a.is(":checked");function E(e){0!==e.length&&(r.css("overflow-y","hidden"),e[0].isInputError&&s.addClass("form-item-error"),c.text(e[0].message),n.addClass("is-active is-animated"),n.removeClass("is-hidden"),n.find(".js-close-dialog").focus().on("click tap",function(){r.css("overflow-y","visible"),s.removeClass("form-item-error")}),u=[])}t.prop("disabled",!p.isGeolocationCapable()).toggleClass("disabled",!p.isGeolocationCapable()).on("click",function(e){e.stopPropagation(),e.preventDefault(),p.geolocalize(d,m).fail(function(e){var r=p.ERROR_CODES.GEOLOC;switch(e){case r.GEOLOC_UNAVAILABLE:u.push({message:"Votre position n'a pas pu être récupérée",isInputError:!1});break;case r.POSITION_UNAVAILABLE:u.push({message:"Impossible de récupérer votre position",isInputError:!1});break;case r.PERMISSION_DENIED:u.push({message:"Impossible d'accéder à votre localisation. Veuillez autoriser notre site à connaître votre position",isInputError:!1});break;case r.TIMEOUT:u.push({message:"Votre demande de géolocalisation a expirée",isInputError:!1});break;default:u.push({message:"Service temporairement indisponible. Nos équipes sont mobilisées pour résoudre ce problème.",isInputError:!1})}E(u)})}),e.submit(function(e){e.stopPropagation(),e.preventDefault(),d=o.filter(":checked").val(),m=a.is(":checked");var e=i.val(),r=l.val();p.searchAddress(e,r,d,m).progress(function(e){if(!v.isEmptyObject(e)){var r=e.status,e=e.results,s='<div class="list-examples js-scrollbar"><ul></ul></div>',o=p.GEOCODE_STATUS;switch(r){case o.SELECT_CITY:l.after(s);break;case o.SELECT_STREET:i.after(s);break;default:throw new Error("Bad status")}var a=v(".list-examples"),t=a.find("ul");t.empty(),e.forEach(function(r){t.append(v("<li></li>").text(r.label).on("click tap",function(e){e.stopPropagation(),e.preventDefault(),p.selectResult(r),a.remove()}))}),a.show()}}).fail(function(e){var r=p.ERROR_CODES.GEOCODE;switch(e){case r.CITY_NOT_FOUND_ERROR:u.push({message:"Aucun résultat ne correspond à votre recherche. Veuillez saisir une ville ou un code postal valide.",isInputError:!0});break;case r.STREET_NOT_FOUND_ERROR:u.push({message:"Aucun résultat ne correspond à votre recherche. Veuillez saisir une adresse valide.",isInputError:!0});break;default:u.push({message:"Aucun résultat ne correspond à votre recherche. Veuillez saisir une ville, un code postal ou une adresse valide.",isInputError:!0})}E(u)})})})})})(jQuery);